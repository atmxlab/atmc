
## ATMC ‚Äî —è–∑—ã–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

ATMC ‚Äî –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π, –Ω–æ –º–æ—â–Ω—ã–π —è–∑—ã–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫.  
–û–Ω —Å–æ—á–µ—Ç–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ—Ç—É —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞, –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏–º–ø–æ—Ä—Ç–æ–≤, –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ –≥–∏–±–∫–æ–µ —Å–ª–∏—è–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```shell
go get github.com/atmxlab/atmc
```

## –§–ò–ß–ò:

- —Ç–æ–ø–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
    - —Å—É–ø–µ—Ä –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π
    - –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π –∏ –ø—Ä–æ—Å—Ç–æ–π
    - –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
    - –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ—Ç—Å—Ç—É–ø–æ–≤ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ –∏ –ø—Ä–æ—á–µ–π —á–µ–ø—É—Ö–∏
    - –∑–∞–ø—è—Ç—ã–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
    - –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π –∏ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ—â–Ω—ã–π
- –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
    - –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∫—É—Å–æ—á–∫–∏ (–º–æ–¥—É–ª–∏) –∫–æ–Ω—Ñ–∏–≥–∞
    - –æ—á–µ–Ω—å –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∏–º–ø–æ—Ä—Ç–∞
    - –º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –≤–ª–æ–∂–µ–Ω–Ω—ã–º –ø–æ–ª—è–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞
- —Å–ª–∏—è–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ (–∫–∏–ª–ª–µ—Ä —Ñ–∏—á–∞)
    - —Å—É–ø–µ—Ä –ª–µ–≥–∫–æ –º–µ—Ä–¥–∂–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, common + stg –∏–ª–∏ prod -> –∫–ª–∞—Å—Å–∏–∫–∞)
    - –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ–ª—è
    - —É–º–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ - –Ω–µ –ø–µ—Ä–µ—Ç–∏—Ä–∞–µ—Ç –ø–æ–ª–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ
    - –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –∏ –º–∞—Å—Å–∏–≤—ã —Å –ø–æ–º–æ—â—å—é spread (...) –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
    - —Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –∂–µ –∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–∏—è–Ω–∏–µ
- –¥–æ—Å—Ç—É–ø –∫ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
    - $YOUR_ENV_VARIABLE
- –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ç–∏–ø–æ–≤
    - int
    - float
    - string
    - bool
    - object
    - array
- –º–∞–ø–ø–∏–Ω–≥ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –º–∞–ø—É –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä

üìÑFile: `config.atmc`

```js
{
    logging: {
        level: ["warn", "error"]
    }
    database: {
        clickhouse: {
            username: "username"
            password: "password"
            port: 9000
        }
    }
}
```

### –ü—Ä–∏–º–µ—Ä —Å –∏–º–ø–æ—Ä—Ç–æ–º

üìÑFile: `config.atmc`

```js
db ./database.atmc // –°—É–ø–µ—Ä –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∏–º–ø–æ—Ä—Ç

{
    logging: {
        level: ["warn", "error"]
    }
    database: db // –¢—É—Ç –ø–æ—è–≤–∏—Ç—Å—è –æ–±—ä–µ–∫—Ç –∏–∑ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
}
```

üìÑFile: `database.atmc`

```js
{
    database: {
        clickhouse: {
            username: "username"
            password: "password"
            port: 9000
        }
    }
}
```

### –ü—Ä–∏–º–µ—Ä —Å spread + env

üìÑFile: `config.atmc`

```js
db ./database.atmc

{
    logging: {
        level: ["warn", "error"]
    }
    database: {
        postgres: {
            username: $POSGRES_USERNAME // –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ env
            password: $POSGRES_PASSWORD
        }
        db... // –°—é–¥–∞ –≤—Å—Ç—Ä–æ–∏—Ç—Å—è –∏—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
    }
}
```

üìÑFile: `database.atmc`

```js
{
    database: {
        clickhouse: {
            username: "username"
            password: "password"
            port: 9000
        }
    }
}
```

### –ü—Ä–∏–º–µ—Ä —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –≤–ª–æ–∂–µ–Ω–Ω–æ–º—É –ø–æ–ª—é

üìÑFile: `config.atmc`

```js
db ./database.atmc

{
    logging: {
        level: ["warn", "error"]
    }
    database: {
        postgres: {
            username: $POSGRES_USERNAME // –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ env
            password: $POSGRES_PASSWORD
        }
        clickhouse: db.clickhouse // –°—é–¥–∞ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω –≤–ª–æ–∂–µ–Ω–Ω—ã–π –≤ db –æ–±—ä–µ–∫—Ç
    }
}
```

üìÑFile: `database.atmc`

```js
{
    database: {
        clickhouse: {
            username: "username"
            password: "password"
            port: 9000
        }
    }
}
```

### –ü—Ä–∏–º–µ—Ä —Å–æ —Å–ª–∏—è–Ω–∏–µ–º

üìÑFile: `common.atmc`

```js
{
    logging: {
        level: ["error"]
    }
    database: {
        postgres: {
            username: $POSGRES_USERNAME
            password: $POSGRES_PASSWORD
            host: "localhost"
            port: 5432
        }
    }
}
```

üìÑFile: `prod.atmc` - –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è prod –æ–∫—Ä—É–∂–µ–Ω–∏—è

```js
common ./common.atmc

{
    common... // –í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –æ–±—â–∏–π –∫–æ–Ω—Ñ–∏–≥
    // –î–∞–ª–µ–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –æ–±—â–µ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞
    logging: {
        level: ["warn", "error"] // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è
        enable_tracing: true // –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–æ–µ –ø–æ–ª–µ
    }
    database: {
        postgres: {
            port: 6432 // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –Ω–µ –±—É–¥—É—Ç –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã      
        }
    }
}
```

üìÑFile: `stage.atmc` - –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è stage –æ–∫—Ä—É–∂–µ–Ω–∏—è

```js
common ./common.atmc

{
    common... // –í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –æ–±—â–∏–π –∫–æ–Ω—Ñ–∏–≥
    // –î–∞–ª–µ–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –æ–±—â–µ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞
    logging: {
        // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è - –º–æ–∂–Ω–æ –±–µ–∑ –∑–∞–ø—è—Ç—ã—Ö
        level: [
            "info"
            "warn"
            "error"
        ]
    }
}
```

## –ß—Ç–æ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º?

–Ø–∑—ã–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è –º–Ω–æ–∂–µ—Å—Ç–≤—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- lexer
    - –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–æ–¥ –≤ —Ç–æ–∫–µ–Ω—ã
- parser
    - –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ç–æ–∫–µ–Ω—ã –≤ AST
- analyzer
    - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ–º–∞–Ω—Ç–∏–∫—É –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ AST
    - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- linker
    - —Ä–µ–∑–æ–ª–≤–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö AST
    - —Ä–µ–∑–æ–ª–≤–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã
    - –≤—ã–¥–∞–µ—Ç –æ–¥–∏–Ω –∏—Ç–æ–≥–æ–≤—ã–π AST
- processor
    - –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –∫–æ–Ω—Ñ–∏–≥–æ–º
    - –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
    - –æ—Ç–¥–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏—Ç–æ–≥–æ–≤—ã–π AST –ø–æ—Å–ª–µ –ª–∏–Ω–∫–æ–≤–∫–∏
- compiler
    - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π AST
    - –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏ (–≤ map, –≤ struct)

## –§–ò–ß–ò –≤ –ø–ª–∞–Ω–∞—Ö:

- –∫–æ–º–ø–∏–ª—è—Ü–∏—è –≤ —Å–∞–º–æ–≥–æ —Å–µ–±—è
    - –±—É–¥–µ—Ç —É–¥–æ–±–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥
    - –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥, –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, `nginx -t`
- –∫–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –Ω–∞ –±–∞–∑–µ –∫–æ–Ω—Ñ–∏–≥–∞
    - —Ç–æ–≥–¥–∞ –æ–ø–∏—Å—ã–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–∏–¥–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ - –≤ atmc —Ñ–∞–π–ª–µ
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ .env —Ñ–∞–π–ª–∞
    - —Å–µ–π—á–∞—Å —Ç–∞–∫–æ–≥–æ –Ω–µ—Ç - –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–∞–º–∏–º –∑–∞–≥—Ä—É–∂–∞—Ç—å, —á—Ç–æ–±—ã –æ–Ω–∏ —Å—Ç–∞–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ os.Getenv
    - –Ω–æ –±—É–¥–µ—Ç —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å
- –ø–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è LSP
    - —É–º–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
    - –ø–æ–¥—Å–∫–∞–∑–∫–∏
    - –ø–æ–∏—Å–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ –ø–æ–º–æ—â—å –≤ –∏–º–ø–æ—Ä—Ç–∞—Ö